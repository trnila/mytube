/*
 MIT
*/
(function(e,g){if("function"!=typeof e)return console.error("nette.ajax.js: jQuery is missing, load it please");e.nette=new (e.extend(function(){var a={self:this,initialized:!1,contexts:{},on:{init:{},load:{},prepare:{},before:{},start:{},success:{},complete:{},error:{}},fire:function(){var b=!0,c=Array.prototype.slice.call(arguments),d=c.shift(),f="string"==typeof d?d:d.name,h="object"==typeof d?d.off||{}:{};c.push(a.self);e.each(a.on[f],function(d,f){if(f===g||-1!==e.inArray(d,h))return!0;var j=
f.apply(a.contexts[d],c);return b=j===g||j});return b},requestHandler:function(b){a.self.ajax({},this,b)},ext:function(b,c,d){for(;!d;)d="ext_"+Math.random(),a.contexts[d]&&(d=g);e.each(b,function(b,c){a.on[b][d]=c});a.contexts[d]=e.extend(c?c:{},{name:function(){return d},ext:function(b,c){var d=a.contexts[b];if(!d&&c)throw"Extension '"+this.name()+"' depends on disabled extension '"+b+"'.";return d}})}};this.ext=function(b,c,d){if("object"==typeof b)a.ext(b,c);else{if(c===g)return a.contexts[b];
if(c){if("string"==typeof b&&a.contexts[b]!==g)throw"Cannot override already registered nette-ajax extension.";a.ext(c,d,b)}else e.each("init load before start success complete error".split(" "),function(c,d){a.on[d][b]=g}),a.contexts[b]=g}return this};this.init=function(b,c){if(a.initialized)throw"Cannot initialize nette-ajax twice.";if("function"==typeof b)this.ext("init",null),this.ext("init",{load:b},c);else if("object"==typeof b)this.ext("init",null),this.ext("init",b,c);else if(b!==g)throw"Argument of init() can be function or function-hash only.";
a.initialized=!0;a.fire("init");this.load();return this};this.load=function(){a.fire("load",a.requestHandler);return this};this.ajax=function(b,c,d){if(!b.nette&&c&&d){var f=e(c),h,d=b.nette={e:d,ui:c,el:f,isForm:f.is("form"),isSubmit:f.is("input[type=submit]"),isImage:f.is("input[type=image]"),form:null};d.isSubmit||d.isImage?d.form=d.el.closest("form"):d.isForm&&(d.form=d.el);b.url||(b.url=d.form?d.form.attr("action"):c.href);b.type||(b.type=d.form?d.form.attr("method"):"get");f.is("[data-ajax-off]")&&
(b.off=f.data("ajaxOff"),"string"==typeof b.off&&(b.off=[b.off]))}a.fire({name:"prepare",off:b.off||{}},b);b.prepare&&b.prepare(b);h=b.beforeSend;b.beforeSend=function(b,c){if(h){var d=h(b,c);if(d!==g&&!d)return d}return a.fire({name:"before",off:c.off||{}},b,c)};if(c=e.ajax(b))c.done(function(c,d,e){a.fire({name:"success",off:b.off||{}},c,d,e)}).fail(function(c,d,e){a.fire({name:"error",off:b.off||{}},c,d,e)}).always(function(c,d){a.fire({name:"complete",off:b.off||{}},c,d)}),a.fire({name:"start",
off:b.off||{}},c,b),b.start&&b.start(c,b);return c}},e.nette?e.nette:{}));e.fn.netteAjax=function(a,b){return e.nette.ajax(b||{},this[0],a)};e.nette.ext("validation",{before:function(a,b){if(b.nette)var c=b.nette;else return!0;var d=c.e,f=e.extend({keys:!0,url:!0,form:!0},b.validate||function(){if(c.el.is("[data-ajax-validate]")){var b=c.el.data("ajaxValidate");if(!1===b)return{keys:!1,url:!1,form:!1};if("object"==typeof b)return b}}()||{}),h=!1;c.el.attr("data-ajax-pass")!==g&&(h=c.el.data("ajaxPass"),
h="bool"==typeof h?h:!0);if(f.keys){var i=d.button||d.ctrlKey||d.shiftKey||d.altKey||d.metaKey;if(c.form){if(i&&c.isSubmit)return this.explicitNoAjax=!0,!1;if(c.isForm&&this.explicitNoAjax)return this.explicitNoAjax=!1}else if(i)return!1}if(f.form&&c.form&&!((c.isSubmit||c.isImage)&&c.el.attr("formnovalidate")!==g)&&c.form.get(0).onsubmit&&!c.form.get(0).onsubmit())return d.stopImmediatePropagation(),d.preventDefault(),!1;if(f.url&&/:|^#/.test(c.form?b.url:c.el.attr("href")))return!1;h||(d.stopPropagation(),
d.preventDefault());return!0}},{explicitNoAjax:!1});e.nette.ext("state",{prepare:function(a){this.state&&("string"==typeof a.data?a.data+="&"+e.param(this.state):"object"==typeof a.data?a.data=e.extend(a.data||{},this.state):a.data||(a.data=this.state))},success:function(a){a.state&&(this.state=a.state)}},{state:null});e.nette.ext("forms",{success:function(a){var b;if(window.Nette&&a.snippets&&(b=this.ext("snippets")))for(var c in a.snippets)b.getElement(c).find("form").each(function(){window.Nette.initForm(this)})},
prepare:function(a){var b=a.nette;if(b&&b.form){var c=b.e,d=a.data||{},f={};if(b.isSubmit)f[b.el.attr("name")]=b.el.val()||"";else if(b.isImage){var g=b.el.offset(),i=b.el.attr("name"),c=[Math.max(0,c.pageX-g.left),Math.max(0,c.pageY-g.top)];-1!==i.indexOf("[",0)?f[i]=c:(f[i+".x"]=c[0],f[i+".y"]=c[1])}"string"!=typeof d&&(d=e.param(d));f=e.param(f);a.data=b.form.serialize()+(f?"&"+f:"")+"&"+d}}});e.nette.ext("snippets",{success:function(a){if(a.snippets)for(var b in a.snippets)this.updateSnippet(b,
a.snippets[b])}},{updateSnippet:function(a,b,c){a=this.getElement(a);"TITLE"==a.eq(0).tagName?document.title=b:this.applySnippet(a,b,c)},getElement:function(a){return e("#"+this.escapeSelector(a))},applySnippet:function(a,b,c){!c&&a.is("[data-ajax-append]")?a.append(b):a.html(b)},escapeSelector:function(a){return a.replace(/[\!"#\$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|\}~]/g,"\\$&")}});e.nette.ext("redirect",{success:function(a){if(a.redirect)return window.location.href=a.redirect,!1}});e.nette.ext("unique",
{start:function(a){this.xhr&&this.xhr.abort();this.xhr=a},complete:function(){this.xhr=null}},{xhr:null});e.nette.ext("abort",{init:function(){e("body").keydown(e.proxy(function(a){this.xhr&&(27==a.keyCode&&!a.ctrlKey&&!a.shiftKey&&!a.altKey&&!a.metaKey)&&this.xhr.abort()},this))},start:function(a){this.xhr=a},complete:function(){this.xhr=null}},{xhr:null});e.nette.ext("init",{load:function(a){e(this.linkSelector).off("click.nette",a).on("click.nette",a);var b=e(this.formSelector);b.off("submit.nette",
a).on("submit.nette",a);b.off("click.nette",":image",a).on("click.nette",":image",a);b.off("click.nette",":submit",a).on("click.nette",":submit",a);var c=this.buttonSelector;e(c).each(function(){e(this).closest("form").off("click.nette",c,a).on("click.nette",c,a)})},success:function(){e.nette.load()}},{linkSelector:"a.ajax",formSelector:"form.ajax",buttonSelector:'input.ajax[type="submit"], input.ajax[type="image"]'})})(window.jQuery);(function(e){e.nette.ext("diagnostics.dumps",{success:function(g){if(g.netteDumps&&0!=g.netteDumps.length){var a=this.getPanel(),b=e("<div>");e(this.getTitle(++this.counter)).appendTo(a);e.each(g.netteDumps,function(a,d){d.title&&e("<h2>",{text:d.title}).appendTo(b);var f=e("<table>").appendTo(b),a=0;e.each(d.dump,function(b,d){e("<th>");f.append(e("<tr>",{"class":a++%2?"nette-alt":"",html:"<th>"+b+"</th><td>"+d+"</td>"}))})});b.children().appendTo(a);this.notify()}}},{counter:0,getTitle:function(e){return"<h2>Ajax request #"+
e+"</h2>"},getTab:function(){this.tab||(this.tab=e("[rel=Nette-Diagnostics-DefaultBarPanel-4]"));return this.tab},getPanel:function(){this.panel||(this.panel=e("#nette-debug-panel-Nette-Diagnostics-DefaultBarPanel-4 .nette-DumpPanel"));return this.panel},notify:function(){this.notified||(e("<strong>",{text:" [ajax!]",css:{fontWeight:"bold"}}).appendTo(this.getTab()),this.notified=!0)}})})(jQuery);(function(e){e.nette.ext("scrollTo",{success:function(e){var a=this.ext("snippets",!0);if(e.snippets)for(var b in e.snippets)if(e=a.getElement(b),"TITLE"!=e.eq(0).tagName){a=e.offset();scrollTo(a.left,a.top);break}}})})(jQuery);(function(e){if(window.history&&history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/)){e.nette.ext("redirect",!1);var g=function(){var b=[];e('[id^="snippet--"]').each(function(){var a=e(this);b.push({id:a.attr("id"),html:a.html()})});return b},a=function(b,a,d){(a=b["handle"+a.substring(0,1).toUpperCase()+a.substring(1)])&&a.apply(b,d)};e.nette.ext("history",{init:function(){var b=this.stateExt=this.ext("state",!0),c=
this.ext("snippets");this.cache&&c&&(this.handleUI=function(b){e.each(b,function(){c.updateSnippet(this.id,this.html,!0)});e.nette.load()});history.replaceState(this.initialState={nette:!0,href:window.location.href,state:{},title:document.title,ui:g()},document.title,window.location.href);e(window).on("popstate.nette",e.proxy(function(c){var f=c.originalEvent.state||this.initialState;!window.history.ready&&(f&&f.nette)&&(this.cache&&f.ui?(a(this,"UI",[f.ui]),a(this,"title",[f.title]),a(this,"state",
[f.state])):e.nette.ajax({url:f.href,off:["history","state"]}).done(function(a){a.state&&(b.state=f)}))},this))},before:function(b,a){this.href=a.nette?a.nette.form?"get"==a.nette.form.method?a.nette.ui.action||window.location.href:null:a.nette.ui.href:null},success:function(a){var c=a.redirect||a.url;if(c){var d=RegExp("//"+window.location.host+"($|/)");("http"===c.substring(0,4)?d.test(c):1)?this.href=c:window.location.href=c}if((!a.signal||c)&&this.href&&this.href!=window.location.href)history.pushState({nette:!0,
href:this.href,state:a.state||null,title:document.title,ui:g()},document.title,this.href);this.href=null}},{href:null,cache:!0,handleTitle:function(a){document.title=a},handleState:function(a){this.stateExt.state=a}})}})(jQuery);(function(){function e(){webkitRequestAnimationFrame(e);var c=new Uint8Array(g.frequencyBinCount);g.getByteFrequencyData(c);b.clearRect(0,0,a.width,a.height);for(var f=0;f<c.length;f++)b.fillRect(f,a.height-c[f],10,a.height),f+=10}var g,a,b;window.addEventListener("load",function(){if(c=document.getElementById("music")){var d=new webkitAudioContext;g=d.createAnalyser();d.createMediaElementSource(c).connect(g);g.connect(d.destination);c.play();a=document.getElementsByTagName("canvas")[0];a.width=1024;
a.height=255;b=a.getContext("2d");d=b.createLinearGradient(0,0,0,a.height);d.addColorStop(0,"red");d.addColorStop(0.5,"yellow");d.addColorStop(1,"green");b.fillStyle=d;e()}},!1);var c})();$(function(){$.nette.ext("history").cache=!1;$.nette.init()});
