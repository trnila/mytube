/*
 MIT
*/
(function(c,f){if("function"!=typeof c)return console.error("nette.ajax.js: jQuery is missing, load it please");c.nette=new (c.extend(function(){var a={self:this,initialized:!1,contexts:{},on:{init:{},load:{},prepare:{},before:{},start:{},success:{},complete:{},error:{}},fire:function(){var b=!0,d=Array.prototype.slice.call(arguments),e=d.shift(),g="string"==typeof e?e:e.name,h="object"==typeof e?e.off||{}:{};d.push(a.self);c.each(a.on[g],function(e,g){if(g===f||-1!==c.inArray(e,h))return!0;var j=
g.apply(a.contexts[e],d);return b=j===f||j});return b},requestHandler:function(b){a.self.ajax({},this,b)},ext:function(b,d,e){for(;!e;)e="ext_"+Math.random(),a.contexts[e]&&(e=f);c.each(b,function(b,d){a.on[b][e]=d});a.contexts[e]=c.extend(d?d:{},{name:function(){return e},ext:function(b,d){var c=a.contexts[b];if(!c&&d)throw"Extension '"+this.name()+"' depends on disabled extension '"+b+"'.";return c}})}};this.ext=function(b,d,e){if("object"==typeof b)a.ext(b,d);else{if(d===f)return a.contexts[b];
if(d){if("string"==typeof b&&a.contexts[b]!==f)throw"Cannot override already registered nette-ajax extension.";a.ext(d,e,b)}else c.each("init load before start success complete error".split(" "),function(d,c){a.on[c][b]=f}),a.contexts[b]=f}return this};this.init=function(b,d){if(a.initialized)throw"Cannot initialize nette-ajax twice.";if("function"==typeof b)this.ext("init",null),this.ext("init",{load:b},d);else if("object"==typeof b)this.ext("init",null),this.ext("init",b,d);else if(b!==f)throw"Argument of init() can be function or function-hash only.";
a.initialized=!0;a.fire("init");this.load();return this};this.load=function(){a.fire("load",a.requestHandler);return this};this.ajax=function(b,d,e){if(!b.nette&&d&&e){var g=c(d),h,e=b.nette={e:e,ui:d,el:g,isForm:g.is("form"),isSubmit:g.is("input[type=submit]"),isImage:g.is("input[type=image]"),form:null};e.isSubmit||e.isImage?e.form=e.el.closest("form"):e.isForm&&(e.form=e.el);b.url||(b.url=e.form?e.form.attr("action"):d.href);b.type||(b.type=e.form?e.form.attr("method"):"get");g.is("[data-ajax-off]")&&
(b.off=g.data("ajaxOff"),"string"==typeof b.off&&(b.off=[b.off]))}a.fire({name:"prepare",off:b.off||{}},b);b.prepare&&b.prepare(b);h=b.beforeSend;b.beforeSend=function(b,d){if(h){var c=h(b,d);if(c!==f&&!c)return c}return a.fire({name:"before",off:d.off||{}},b,d)};if(d=c.ajax(b))d.done(function(d,c,e){a.fire({name:"success",off:b.off||{}},d,c,e)}).fail(function(d,c,e){a.fire({name:"error",off:b.off||{}},d,c,e)}).always(function(d,c){a.fire({name:"complete",off:b.off||{}},d,c)}),a.fire({name:"start",
off:b.off||{}},d,b),b.start&&b.start(d,b);return d}},c.nette?c.nette:{}));c.fn.netteAjax=function(a,b){return c.nette.ajax(b||{},this[0],a)};c.nette.ext("validation",{before:function(a,b){if(b.nette)var d=b.nette;else return!0;var e=d.e,g=c.extend({keys:!0,url:!0,form:!0},b.validate||function(){if(d.el.is("[data-ajax-validate]")){var b=d.el.data("ajaxValidate");if(!1===b)return{keys:!1,url:!1,form:!1};if("object"==typeof b)return b}}()||{}),h=!1;d.el.attr("data-ajax-pass")!==f&&(h=d.el.data("ajaxPass"),
h="bool"==typeof h?h:!0);if(g.keys){var i=e.button||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey;if(d.form){if(i&&d.isSubmit)return this.explicitNoAjax=!0,!1;if(d.isForm&&this.explicitNoAjax)return this.explicitNoAjax=!1}else if(i)return!1}if(g.form&&d.form&&!((d.isSubmit||d.isImage)&&d.el.attr("formnovalidate")!==f)&&d.form.get(0).onsubmit&&!d.form.get(0).onsubmit())return e.stopImmediatePropagation(),e.preventDefault(),!1;if(g.url&&/:|^#/.test(d.form?b.url:d.el.attr("href")))return!1;h||(e.stopPropagation(),
e.preventDefault());return!0}},{explicitNoAjax:!1});c.nette.ext("state",{prepare:function(a){this.state&&("string"==typeof a.data?a.data+="&"+c.param(this.state):"object"==typeof a.data?a.data=c.extend(a.data||{},this.state):a.data||(a.data=this.state))},success:function(a){a.state&&(this.state=a.state)}},{state:null});c.nette.ext("forms",{success:function(a){var b;if(window.Nette&&a.snippets&&(b=this.ext("snippets")))for(var d in a.snippets)b.getElement(d).find("form").each(function(){window.Nette.initForm(this)})},
prepare:function(a){var b=a.nette;if(b&&b.form){var d=b.e,e=a.data||{},f={};if(b.isSubmit)f[b.el.attr("name")]=b.el.val()||"";else if(b.isImage){var h=b.el.offset(),i=b.el.attr("name"),d=[Math.max(0,d.pageX-h.left),Math.max(0,d.pageY-h.top)];-1!==i.indexOf("[",0)?f[i]=d:(f[i+".x"]=d[0],f[i+".y"]=d[1])}"string"!=typeof e&&(e=c.param(e));f=c.param(f);a.data=b.form.serialize()+(f?"&"+f:"")+"&"+e}}});c.nette.ext("snippets",{success:function(a){if(a.snippets)for(var b in a.snippets)this.updateSnippet(b,
a.snippets[b])}},{updateSnippet:function(a,b,d){a=this.getElement(a);"TITLE"==a.eq(0).tagName?document.title=b:this.applySnippet(a,b,d)},getElement:function(a){return c("#"+this.escapeSelector(a))},applySnippet:function(a,b,d){!d&&a.is("[data-ajax-append]")?a.append(b):a.html(b)},escapeSelector:function(a){return a.replace(/[\!"#\$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|\}~]/g,"\\$&")}});c.nette.ext("redirect",{success:function(a){if(a.redirect)return window.location.href=a.redirect,!1}});c.nette.ext("unique",
{start:function(a){this.xhr&&this.xhr.abort();this.xhr=a},complete:function(){this.xhr=null}},{xhr:null});c.nette.ext("abort",{init:function(){c("body").keydown(c.proxy(function(a){this.xhr&&(27==a.keyCode&&!a.ctrlKey&&!a.shiftKey&&!a.altKey&&!a.metaKey)&&this.xhr.abort()},this))},start:function(a){this.xhr=a},complete:function(){this.xhr=null}},{xhr:null});c.nette.ext("init",{load:function(a){c(this.linkSelector).off("click.nette",a).on("click.nette",a);var b=c(this.formSelector);b.off("submit.nette",
a).on("submit.nette",a);b.off("click.nette",":image",a).on("click.nette",":image",a);b.off("click.nette",":submit",a).on("click.nette",":submit",a);var d=this.buttonSelector;c(d).each(function(){c(this).closest("form").off("click.nette",d,a).on("click.nette",d,a)})},success:function(){c.nette.load()}},{linkSelector:"a.ajax",formSelector:"form.ajax",buttonSelector:'input.ajax[type="submit"], input.ajax[type="image"]'})})(window.jQuery);(function(c){c.nette.ext("diagnostics.dumps",{success:function(f){if(f.netteDumps&&0!=f.netteDumps.length){var a=this.getPanel(),b=c("<div>");c(this.getTitle(++this.counter)).appendTo(a);c.each(f.netteDumps,function(a,e){e.title&&c("<h2>",{text:e.title}).appendTo(b);var f=c("<table>").appendTo(b),a=0;c.each(e.dump,function(b,e){c("<th>");f.append(c("<tr>",{"class":a++%2?"nette-alt":"",html:"<th>"+b+"</th><td>"+e+"</td>"}))})});b.children().appendTo(a);this.notify()}}},{counter:0,getTitle:function(c){return"<h2>Ajax request #"+
c+"</h2>"},getTab:function(){this.tab||(this.tab=c("[rel=Nette-Diagnostics-DefaultBarPanel-4]"));return this.tab},getPanel:function(){this.panel||(this.panel=c("#nette-debug-panel-Nette-Diagnostics-DefaultBarPanel-4 .nette-DumpPanel"));return this.panel},notify:function(){this.notified||(c("<strong>",{text:" [ajax!]",css:{fontWeight:"bold"}}).appendTo(this.getTab()),this.notified=!0)}})})(jQuery);(function(c){c.nette.ext("scrollTo",{success:function(c){var a=this.ext("snippets",!0);if(c.snippets)for(var b in c.snippets)if(c=a.getElement(b),"TITLE"!=c.eq(0).tagName){a=c.offset();scrollTo(a.left,a.top);break}}})})(jQuery);(function(c){if(window.history&&history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/)){c.nette.ext("redirect",!1);var f=function(){var b=[];c('[id^="snippet--"]').each(function(){var a=c(this);b.push({id:a.attr("id"),html:a.html()})});return b},a=function(b,a,c){(a=b["handle"+a.substring(0,1).toUpperCase()+a.substring(1)])&&a.apply(b,c)};c.nette.ext("history",{init:function(){var b=this.stateExt=this.ext("state",!0),d=
this.ext("snippets");this.cache&&d&&(this.handleUI=function(b){c.each(b,function(){d.updateSnippet(this.id,this.html,!0)});c.nette.load()});history.replaceState(this.initialState={nette:!0,href:window.location.href,state:{},title:document.title,ui:f()},document.title,window.location.href);c(window).on("popstate.nette",c.proxy(function(d){var f=d.originalEvent.state||this.initialState;!window.history.ready&&(f&&f.nette)&&(this.cache&&f.ui?(a(this,"UI",[f.ui]),a(this,"title",[f.title]),a(this,"state",
[f.state])):c.nette.ajax({url:f.href,off:["history","state"]}).done(function(a){a.state&&(b.state=f)}))},this))},before:function(b,a){this.href=a.nette?a.nette.form?"get"==a.nette.form.method?a.nette.ui.action||window.location.href:null:a.nette.ui.href:null},success:function(b){var a=b.redirect||b.url;if(a){var c=RegExp("//"+window.location.host+"($|/)");("http"===a.substring(0,4)?c.test(a):1)?this.href=a:window.location.href=a}if((!b.signal||a)&&this.href&&this.href!=window.location.href)history.pushState({nette:!0,
href:this.href,state:b.state||null,title:document.title,ui:f()},document.title,this.href);this.href=null}},{href:null,cache:!0,handleTitle:function(a){document.title=a},handleState:function(a){this.stateExt.state=a}})}})(jQuery);var analyser,canvas,canvasContext;window.addEventListener("load",init,!1);function init(){setupWebAudio();setupDrawingCanvas();draw()}function setupWebAudio(){var c=document.getElementById("music"),f=new webkitAudioContext;analyser=f.createAnalyser();f.createMediaElementSource(c).connect(analyser);analyser.connect(f.destination);c.play()}
function draw(){webkitRequestAnimationFrame(draw);var c=new Uint8Array(analyser.frequencyBinCount);analyser.getByteFrequencyData(c);canvasContext.clearRect(0,0,canvas.width,canvas.height);for(var f=0;f<c.length;f++)canvasContext.fillRect(f,canvas.height-c[f],10,canvas.height),f+=10}
function setupDrawingCanvas(){canvas=document.getElementsByTagName("canvas")[0];canvas.width=1024;canvas.height=255;console.log(canvas);canvasContext=canvas.getContext("2d");var c=canvasContext.createLinearGradient(0,0,0,canvas.height);c.addColorStop(0,"red");c.addColorStop(0.5,"yellow");c.addColorStop(1,"green");canvasContext.fillStyle=c};$(function(){$.nette.ext("history").cache=!1;$.nette.init()});
